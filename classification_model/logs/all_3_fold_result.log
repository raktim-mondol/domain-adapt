2025-10-14 22:04:23,888 - INFO - Logging initialized. Log file: logs\bma_mil_standard_20251014_220423.log
2025-10-14 22:04:23,889 - INFO - Mode: standard
2025-10-14 22:04:23,889 - INFO - Device: cuda
2025-10-14 22:04:25,048 - INFO - Loading pretrained weights from Hugging Face hub (timm/vit_base_r50_s16_224.orig_in21k)
2025-10-14 22:04:25,321 - INFO - [timm/vit_base_r50_s16_224.orig_in21k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-10-14 22:04:25,933 - INFO - GPU Training - Device: Quadro RTX 8000, Memory: 48.00 GB
2025-10-14 22:04:25,935 - INFO - Optimizer: AdamW, LR=0.0001, WD=1e-05
2025-10-14 22:04:25,935 - INFO - Scheduler: ReduceLROnPlateau, mode=min, patience=5
2025-10-14 22:04:25,935 - INFO - Using weighted CrossEntropyLoss
2025-10-14 22:04:25,936 - INFO - Early stopping: patience=10
2025-10-14 23:31:44,858 - INFO - Epoch 1/100 (Fold 1) - Train Loss: 0.3276, Val Loss: 1.0211, Pile Acc: 0.8400, Pile F1: 0.8235, LR: 1.00e-04
2025-10-14 23:31:45,380 - INFO - [BEST] New best model saved (Pile Acc: 0.8400)
2025-10-15 00:58:54,032 - INFO - Epoch 2/100 (Fold 1) - Train Loss: 0.1781, Val Loss: 1.5602, Pile Acc: 0.8000, Pile F1: 0.8003, LR: 1.00e-04
2025-10-15 00:58:54,032 - INFO - EarlyStopping counter: 1/10 (best: 0.8400 at epoch 1)
2025-10-15 02:25:57,778 - INFO - Epoch 3/100 (Fold 1) - Train Loss: 0.0860, Val Loss: 2.1266, Pile Acc: 0.7600, Pile F1: 0.7609, LR: 1.00e-04
2025-10-15 02:25:57,778 - INFO - EarlyStopping counter: 2/10 (best: 0.8400 at epoch 1)
2025-10-15 03:53:06,202 - INFO - Epoch 4/100 (Fold 1) - Train Loss: 0.0709, Val Loss: 1.6318, Pile Acc: 0.8400, Pile F1: 0.8235, LR: 1.00e-04
2025-10-15 03:53:06,203 - INFO - EarlyStopping counter: 3/10 (best: 0.8400 at epoch 1)
2025-10-15 05:21:54,918 - INFO - Epoch 5/100 (Fold 1) - Train Loss: 0.0535, Val Loss: 2.7020, Pile Acc: 0.8000, Pile F1: 0.7830, LR: 1.00e-04
2025-10-15 05:21:54,918 - INFO - EarlyStopping counter: 4/10 (best: 0.8400 at epoch 1)
2025-10-15 06:48:59,239 - INFO - Epoch 6/100 (Fold 1) - Train Loss: 0.0473, Val Loss: 3.5878, Pile Acc: 0.7600, Pile F1: 0.7609, LR: 1.00e-04
2025-10-15 06:48:59,240 - INFO - EarlyStopping counter: 5/10 (best: 0.8400 at epoch 1)
2025-10-15 08:16:43,499 - INFO - Learning rate reduced: 1.00e-04 -> 5.00e-05
2025-10-15 08:16:43,501 - INFO - Epoch 7/100 (Fold 1) - Train Loss: 0.0405, Val Loss: 3.1036, Pile Acc: 0.8800, Pile F1: 0.8618, LR: 5.00e-05
2025-10-15 08:16:44,073 - INFO - [BEST] New best model saved (Pile Acc: 0.8800)
2025-10-15 09:45:19,081 - INFO - Epoch 8/100 (Fold 1) - Train Loss: 0.0228, Val Loss: 3.3708, Pile Acc: 0.8800, Pile F1: 0.8618, LR: 5.00e-05
2025-10-15 09:45:19,081 - INFO - EarlyStopping counter: 1/10 (best: 0.8800 at epoch 7)
2025-10-15 11:12:20,729 - INFO - Epoch 9/100 (Fold 1) - Train Loss: 0.0190, Val Loss: 5.4206, Pile Acc: 0.8000, Pile F1: 0.8003, LR: 5.00e-05
2025-10-15 11:12:20,730 - INFO - EarlyStopping counter: 2/10 (best: 0.8800 at epoch 7)
2025-10-15 12:40:12,091 - INFO - Epoch 10/100 (Fold 1) - Train Loss: 0.0162, Val Loss: 7.7968, Pile Acc: 0.7600, Pile F1: 0.7609, LR: 5.00e-05
2025-10-15 12:40:12,092 - INFO - EarlyStopping counter: 3/10 (best: 0.8800 at epoch 7)
2025-10-15 14:08:57,494 - INFO - Epoch 11/100 (Fold 1) - Train Loss: 0.0167, Val Loss: 6.4527, Pile Acc: 0.8000, Pile F1: 0.7857, LR: 5.00e-05
2025-10-15 14:08:57,495 - INFO - EarlyStopping counter: 4/10 (best: 0.8800 at epoch 7)
2025-10-15 15:35:58,139 - INFO - Epoch 12/100 (Fold 1) - Train Loss: 0.0188, Val Loss: 6.6188, Pile Acc: 0.7600, Pile F1: 0.7609, LR: 5.00e-05
2025-10-15 15:35:58,140 - INFO - EarlyStopping counter: 5/10 (best: 0.8800 at epoch 7)
2025-10-15 17:03:35,058 - INFO - Learning rate reduced: 5.00e-05 -> 2.50e-05
2025-10-15 17:03:35,059 - INFO - Epoch 13/100 (Fold 1) - Train Loss: 0.0145, Val Loss: 7.0405, Pile Acc: 0.8800, Pile F1: 0.8618, LR: 2.50e-05
2025-10-15 17:03:35,059 - INFO - EarlyStopping counter: 6/10 (best: 0.8800 at epoch 7)
2025-10-15 18:31:07,117 - INFO - Epoch 14/100 (Fold 1) - Train Loss: 0.0118, Val Loss: 6.4362, Pile Acc: 0.8000, Pile F1: 0.8003, LR: 2.50e-05
2025-10-15 18:31:07,118 - INFO - EarlyStopping counter: 7/10 (best: 0.8800 at epoch 7)
2025-10-15 19:58:52,700 - INFO - Epoch 15/100 (Fold 1) - Train Loss: 0.0101, Val Loss: 7.3058, Pile Acc: 0.8400, Pile F1: 0.8235, LR: 2.50e-05
2025-10-15 19:58:52,701 - INFO - EarlyStopping counter: 8/10 (best: 0.8800 at epoch 7)
2025-10-15 21:26:29,766 - INFO - Epoch 16/100 (Fold 1) - Train Loss: 0.0117, Val Loss: 6.3546, Pile Acc: 0.8400, Pile F1: 0.8235, LR: 2.50e-05
2025-10-15 21:26:29,767 - INFO - EarlyStopping counter: 9/10 (best: 0.8800 at epoch 7)
2025-10-15 22:54:10,352 - INFO - Epoch 17/100 (Fold 1) - Train Loss: 0.0075, Val Loss: 7.9367, Pile Acc: 0.8400, Pile F1: 0.8235, LR: 2.50e-05
2025-10-15 22:54:10,353 - INFO - EarlyStopping counter: 10/10 (best: 0.8800 at epoch 7)
2025-10-15 22:54:10,353 - INFO - Early stopping at epoch 17. Best: 0.8800 at epoch 7
2025-10-15 22:54:11,078 - INFO - GPU Training - Device: Quadro RTX 8000, Memory: 48.00 GB
2025-10-15 22:54:11,081 - INFO - Optimizer: AdamW, LR=0.0001, WD=1e-05
2025-10-15 22:54:11,081 - INFO - Scheduler: ReduceLROnPlateau, mode=min, patience=5
2025-10-15 22:54:11,081 - INFO - Using weighted CrossEntropyLoss
2025-10-15 22:54:11,081 - INFO - Early stopping: patience=10
2025-10-16 00:25:27,865 - INFO - Epoch 1/100 (Fold 2) - Train Loss: 0.1110, Val Loss: 2.3331, Pile Acc: 0.8333, Pile F1: 0.8047, LR: 1.00e-04
2025-10-16 00:25:28,390 - INFO - [BEST] New best model saved (Pile Acc: 0.8333)
2025-10-16 01:58:12,675 - INFO - Epoch 2/100 (Fold 2) - Train Loss: 0.0605, Val Loss: 2.7349, Pile Acc: 0.8333, Pile F1: 0.8047, LR: 1.00e-04
2025-10-16 01:58:12,675 - INFO - EarlyStopping counter: 1/10 (best: 0.8333 at epoch 1)
2025-10-16 03:30:51,998 - INFO - Epoch 3/100 (Fold 2) - Train Loss: 0.0422, Val Loss: 3.4108, Pile Acc: 0.8333, Pile F1: 0.8047, LR: 1.00e-04
2025-10-16 03:30:51,999 - INFO - EarlyStopping counter: 2/10 (best: 0.8333 at epoch 1)
2025-10-16 05:03:03,389 - INFO - Epoch 4/100 (Fold 2) - Train Loss: 0.0297, Val Loss: 2.3343, Pile Acc: 0.7917, Pile F1: 0.7516, LR: 1.00e-04
2025-10-16 05:03:03,390 - INFO - EarlyStopping counter: 3/10 (best: 0.8333 at epoch 1)
2025-10-16 06:35:46,019 - INFO - Epoch 5/100 (Fold 2) - Train Loss: 0.0235, Val Loss: 2.8660, Pile Acc: 0.7917, Pile F1: 0.7516, LR: 1.00e-04
2025-10-16 06:35:46,020 - INFO - EarlyStopping counter: 4/10 (best: 0.8333 at epoch 1)
2025-10-16 08:07:59,952 - INFO - Epoch 6/100 (Fold 2) - Train Loss: 0.0262, Val Loss: 3.7324, Pile Acc: 0.7917, Pile F1: 0.7516, LR: 1.00e-04
2025-10-16 08:07:59,952 - INFO - EarlyStopping counter: 5/10 (best: 0.8333 at epoch 1)
2025-10-16 09:41:35,523 - INFO - Learning rate reduced: 1.00e-04 -> 5.00e-05
2025-10-16 09:41:35,524 - INFO - Epoch 7/100 (Fold 2) - Train Loss: 0.0325, Val Loss: 3.6998, Pile Acc: 0.7917, Pile F1: 0.7516, LR: 5.00e-05
2025-10-16 09:41:35,524 - INFO - EarlyStopping counter: 6/10 (best: 0.8333 at epoch 1)
2025-10-16 11:11:07,322 - INFO - Epoch 8/100 (Fold 2) - Train Loss: 0.0075, Val Loss: 4.5205, Pile Acc: 0.7917, Pile F1: 0.7516, LR: 5.00e-05
2025-10-16 11:11:07,322 - INFO - EarlyStopping counter: 7/10 (best: 0.8333 at epoch 1)
2025-10-16 12:42:54,925 - INFO - Epoch 9/100 (Fold 2) - Train Loss: 0.0061, Val Loss: 5.6907, Pile Acc: 0.7917, Pile F1: 0.7516, LR: 5.00e-05
2025-10-16 12:42:54,926 - INFO - EarlyStopping counter: 8/10 (best: 0.8333 at epoch 1)
2025-10-16 14:15:00,486 - INFO - Epoch 10/100 (Fold 2) - Train Loss: 0.0055, Val Loss: 6.5190, Pile Acc: 0.8333, Pile F1: 0.8047, LR: 5.00e-05
2025-10-16 14:15:00,487 - INFO - EarlyStopping counter: 9/10 (best: 0.8333 at epoch 1)
2025-10-16 15:47:18,680 - INFO - Epoch 11/100 (Fold 2) - Train Loss: 0.0057, Val Loss: 6.5922, Pile Acc: 0.7917, Pile F1: 0.7516, LR: 5.00e-05
2025-10-16 15:47:18,681 - INFO - EarlyStopping counter: 10/10 (best: 0.8333 at epoch 1)
2025-10-16 15:47:18,681 - INFO - Early stopping at epoch 11. Best: 0.8333 at epoch 1
2025-10-16 15:47:19,189 - INFO - GPU Training - Device: Quadro RTX 8000, Memory: 48.00 GB
2025-10-16 15:47:19,192 - INFO - Optimizer: AdamW, LR=0.0001, WD=1e-05
2025-10-16 15:47:19,192 - INFO - Scheduler: ReduceLROnPlateau, mode=min, patience=5
2025-10-16 15:47:19,192 - INFO - Using weighted CrossEntropyLoss
2025-10-16 15:47:19,193 - INFO - Early stopping: patience=10
2025-10-16 17:16:28,605 - INFO - Epoch 1/100 (Fold 3) - Train Loss: 0.0626, Val Loss: 0.3076, Pile Acc: 0.9167, Pile F1: 0.9167, LR: 1.00e-04
2025-10-16 17:16:29,131 - INFO - [BEST] New best model saved (Pile Acc: 0.9167)
2025-10-16 18:46:14,739 - INFO - Epoch 2/100 (Fold 3) - Train Loss: 0.0211, Val Loss: 0.6450, Pile Acc: 0.9167, Pile F1: 0.9167, LR: 1.00e-04
2025-10-16 18:46:14,739 - INFO - EarlyStopping counter: 1/10 (best: 0.9167 at epoch 1)
2025-10-16 20:15:54,425 - INFO - Epoch 3/100 (Fold 3) - Train Loss: 0.0182, Val Loss: 0.7157, Pile Acc: 0.9167, Pile F1: 0.9167, LR: 1.00e-04
2025-10-16 20:15:54,425 - INFO - EarlyStopping counter: 2/10 (best: 0.9167 at epoch 1)
2025-10-16 21:45:32,950 - INFO - Epoch 4/100 (Fold 3) - Train Loss: 0.0165, Val Loss: 0.8917, Pile Acc: 0.9167, Pile F1: 0.9167, LR: 1.00e-04
2025-10-16 21:45:32,951 - INFO - EarlyStopping counter: 3/10 (best: 0.9167 at epoch 1)
2025-10-16 23:15:04,179 - INFO - Epoch 5/100 (Fold 3) - Train Loss: 0.0114, Val Loss: 1.0868, Pile Acc: 0.9167, Pile F1: 0.9174, LR: 1.00e-04
2025-10-16 23:15:04,180 - INFO - EarlyStopping counter: 4/10 (best: 0.9167 at epoch 1)
2025-10-17 00:44:26,243 - INFO - Epoch 6/100 (Fold 3) - Train Loss: 0.0140, Val Loss: 0.8269, Pile Acc: 0.9167, Pile F1: 0.9167, LR: 1.00e-04
2025-10-17 00:44:26,243 - INFO - EarlyStopping counter: 5/10 (best: 0.9167 at epoch 1)
2025-10-17 02:13:52,900 - INFO - Learning rate reduced: 1.00e-04 -> 5.00e-05
2025-10-17 02:13:52,900 - INFO - Epoch 7/100 (Fold 3) - Train Loss: 0.0175, Val Loss: 1.5943, Pile Acc: 0.9167, Pile F1: 0.9167, LR: 5.00e-05
2025-10-17 02:13:52,901 - INFO - EarlyStopping counter: 6/10 (best: 0.9167 at epoch 1)
2025-10-17 03:42:13,085 - INFO - Epoch 8/100 (Fold 3) - Train Loss: 0.0031, Val Loss: 2.6161, Pile Acc: 0.9167, Pile F1: 0.9174, LR: 5.00e-05
2025-10-17 03:42:13,086 - INFO - EarlyStopping counter: 7/10 (best: 0.9167 at epoch 1)
2025-10-17 05:11:01,761 - INFO - Epoch 9/100 (Fold 3) - Train Loss: 0.0011, Val Loss: 3.0523, Pile Acc: 0.9167, Pile F1: 0.9167, LR: 5.00e-05
2025-10-17 05:11:01,762 - INFO - EarlyStopping counter: 8/10 (best: 0.9167 at epoch 1)
2025-10-17 06:39:20,274 - INFO - Epoch 10/100 (Fold 3) - Train Loss: 0.0047, Val Loss: 1.8930, Pile Acc: 0.9167, Pile F1: 0.9167, LR: 5.00e-05
2025-10-17 06:39:20,274 - INFO - EarlyStopping counter: 9/10 (best: 0.9167 at epoch 1)
2025-10-17 08:07:55,969 - INFO - Epoch 11/100 (Fold 3) - Train Loss: 0.0036, Val Loss: 1.9662, Pile Acc: 0.9167, Pile F1: 0.9167, LR: 5.00e-05
2025-10-17 08:07:55,970 - INFO - EarlyStopping counter: 10/10 (best: 0.9167 at epoch 1)
2025-10-17 08:07:55,970 - INFO - Early stopping at epoch 11. Best: 0.9167 at epoch 1
2025-10-17 08:07:56,560 - INFO - Cross-Validation Complete - Avg Acc: 0.8767 ± 0.0341, Avg F1: 0.8613 ± 0.0460
